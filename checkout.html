<!DOCTYPE html>
<html lang="en">

<head>
        <!-- Google Tag Manager -->
    <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
    })(window,document,'script','dataLayer','GTM-MG55CXBP');</script>
    <!-- End Google Tag Manager -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gemini Gadgets - Checkout</title>
    <link rel="stylesheet" href="style.css">
</head>

<body>
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MG55CXBP"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
    <header>
        <h1>Checkout</h1>
        <p>Please review your order and fill in your details.</p>
    </header>

    <main class="container">
        <div class="content-wrapper">
            <section id="order-summary-section">
                <h2>Order Summary</h2>
                <div id="order-summary-items">
                </div>
                <p class="cart-total">Total: $<span id="order-total">0.00</span></p>
            </section>

            <aside id="checkout-form-section">
                <h2>Shipping & Payment</h2>
                <form id="checkout-form">
                    <div class="form-group">
                        <label for="name">Full Name</label>
                        <input type="text" id="name" name="name" required>
                    </div>
                    <div class="form-group">
                        <label for="email">Email Address</label>
                        <input type="email" id="email" name="email" required>
                    </div>
                    <div class="form-group">
                        <label for="address">Shipping Address</label>
                        <input type="text" id="address" name="address" required>
                    </div>
                    <div class="form-group">
                        <label for="card-number">Credit Card Number</label>
                        <input type="text" id="card-number" name="card-number" placeholder="XXXX-XXXX-XXXX-XXXX"
                            required>
                    </div>
                    <button type="submit">Place Order</button>
                </form>
            </aside>
        </div>
    </main>

    <footer>
        <p>&copy; 2025 Gemini Gadgets</p>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // --- REFERENCES TO DOM ELEMENTS ---
            const orderItemsContainer = document.getElementById('order-summary-items');
            const orderTotalElement = document.getElementById('order-total');
            const checkoutForm = document.getElementById('checkout-form');

            // --- RETRIEVE CART DATA ---
            // Get the cart from sessionStorage
            const cart = JSON.parse(sessionStorage.getItem('cart'));

            // If there's no cart or it's empty, redirect to home page
            if (!cart || cart.length === 0) {
                orderItemsContainer.innerHTML = '<p>Your cart is empty. Redirecting...</p>';
                setTimeout(() => {
                    window.location.href = 'index.html';
                }, 2000);
                return;
            }

            // --- FUNCTIONS ---

            // Function to display the order summary
            function renderOrderSummary() {
                orderItemsContainer.innerHTML = cart.map(item => `
                    <div class="cart-item">
                        <span>${item.name}</span>
                        <span>$${item.price.toFixed(2)}</span>
                    </div>
                `).join('');

                const total = cart.reduce((sum, item) => sum + item.price, 0);
                orderTotalElement.textContent = total.toFixed(2);
            }

            // Function to handle the final order placement
            function handlePlaceOrder(event) {
                event.preventDefault(); // Prevent the form from submitting traditionally

                // Basic validation
                const name = document.getElementById('name').value;
                const email = document.getElementById('email').value;
                if (!name || !email) {
                    alert('Please fill in all required fields.');
                    return;
                }

                // 1. Show success message
                alert('Thank you for your order! It has been placed successfully. You will now be redirected to the home page.');

                // 2. Clear the cart from storage
                sessionStorage.removeItem('cart');

                // 3. Redirect back to the home page
                window.location.href = 'index.html';
            }

            // --- EVENT LISTENERS ---
            checkoutForm.addEventListener('submit', handlePlaceOrder);

            // --- INITIALIZATION ---
            renderOrderSummary();
        });
    </script>
</body>


</html>
